(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){e.exports=n(35)},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),c=n.n(i),s=n(8),o=(n(30),n(2)),u=n(3),m=n(5),l=n(4),p=n(6),f=(n(31),n(32),0),h=1,d=2,v=3,g=n(18),y=n.n(g),O=(n(33),0),b=9,E=0,j=1,S=2,w=3,k=4,C=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).onRightClick=function(e){e.preventDefault(),"function"===typeof n.props.onItemRightClick&&n.props.onItemRightClick(e)},n.getItemContentByType=function(e){switch(e){case b:return"\ud83d\udca3";case O:return"";default:return e}},n.getClassNameByState=function(e){switch(e){case j:return"item--opened";case k:return"item--exploded";case E:return"item--closed";case w:return"item--closed item--suspicious";case S:return"item--closed item--flagged";default:return"item--closed"}},n.getClassNameByType=function(e){return e>=1&&e<=8?"item--"+e:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.itemElement.addEventListener("contextmenu",this.onRightClick)}},{key:"componentWillUnmount",value:function(){this.itemElement.removeEventListener("contextmenu",this.onRightClick)}},{key:"render",value:function(){var e=this,t=this.getItemContentByType(this.props.type),n=y()("item",this.getClassNameByState(this.props.itemState),this.getClassNameByType(this.props.type));return r.a.createElement("div",{className:n,onClick:this.props.onItemClick,ref:function(t){return e.itemElement=t}},r.a.createElement("span",{className:"item__content"},t))}}]),t}(a.Component),_=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).openTheCell=function(e,t){return function(a){n.props.gameState===f&&n.props.dispatch({type:"MAKE_MAP_BY_POINT",payload:{x:e,y:t}}),n.props.dispatch({type:"OPEN_CELL",payload:{x:e,y:t}})}},n.onItemRightClick=function(e,t){return function(a){n.props.dispatch({type:"TOGGLE_FLAG",payload:{x:e,y:t}})}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"minefield"},this.props.minefield.map(function(t,n){return r.a.createElement("div",{className:"column",key:"column_"+n},Array.from(t).map(function(t,a){return r.a.createElement(C,{key:"item_"+a,type:t,itemState:e.props.statemap[n][a],onItemClick:e.openTheCell(n,a),onItemRightClick:e.onItemRightClick(n,a)})}))}))}}]),t}(a.Component),N=Object(s.b)()(_),I=(n(34),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={timeStart:0,time:0},n.timeUpdate=function(){n.setState({time:Date.now()-n.state.timeStart})},n.getMinutes=function(e){return e/60/1e3|0},n.getSeconds=function(e){return(e%6e4/1e3).toFixed(2)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.gameState,n=e.gameState;t!==f&&n===f?(clearInterval(this.interval),this.setState({timeStart:0,time:0})):t!==h&&n===h?(this.setState({timeStart:Date.now(),time:0}),this.interval=setInterval(this.timeUpdate,10)):t===v||t===d||n!==v&&n!==d||(clearInterval(this.interval),"function"===typeof this.props.onTimerEnd&&this.props.onTimerEnd(this.state.time))}},{key:"render",value:function(){return r.a.createElement("span",null,this.getMinutes(this.state.time),":",this.getSeconds(this.state.time))}}]),t}(a.Component)),T=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).getEmojiByGameState=function(e,t){if(t)return"\ud83d\ude32";switch(e){case v:return"\ud83d\ude0e";case d:return"\ud83d\ude35";default:return"\ud83d\ude42"}},n.startGame=function(){n.props.dispatch({type:"INIT"})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.mines-this.props.flags;return r.a.createElement("div",{className:"scoreboard"},r.a.createElement("div",{className:"mines"},e," "),r.a.createElement("div",{className:"status",onClick:this.startGame},this.getEmojiByGameState(this.props.gameState,this.props.isHold)),r.a.createElement("div",{className:"time"},r.a.createElement(I,{gameState:this.props.gameState})))}}]),t}(a.Component),A=Object(s.b)()(T),R=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.minefield,n=e.statemap,a=e.gameState,i=e.mines,c=e.flags;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"minefield-wrapper"},r.a.createElement(A,{gameState:a,mines:i,flags:c}),r.a.createElement(N,{minefield:t,statemap:n,gameState:a})))}}]),t}(a.Component),x=Object(s.b)(function(e){return{minefield:e.minefield,statemap:e.statemap,gameState:e.gameState,mines:e.mines,flags:e.flags}})(R),L=n(11),B=n(37),G=n(7);function M(e,t,n){if(n>e*t)return M(e,t,e*t);for(var a=new Array(e).fill(null).map(function(e){return new Uint8Array(t)}),r=0;r<n;){var i=Math.random()*e|0,c=Math.random()*t|0;a[i][c]!==b&&(a[i][c]=b,r++)}var s=[[-1,0],[-1,-1],[-1,1],[1,-1],[1,0],[1,1],[0,1],[0,-1]];return a.map(function(e,t){return e.map(function(e,n){return e!==O?e:s.reduce(function(e,r){var i=t+r[0],c=n+r[1];return a[i]&&a[i][c]===b?e+1:e},0)})})}function D(e,t,n,a){var r=a[t].slice();r[n]=e;var i=a.slice();return i[t]=r,i}var P=n(19),U=n(20);var X=[[-1,0],[-1,-1],[-1,1],[1,-1],[1,0],[1,1],[0,1],[0,-1]];function F(e,t,n,a){if(void 0===a[e]||void 0===a[e][t])return a;if(a[e][t]===j)return a;var r=a[e][t]!==S?D(j,e,t,a):a;if(n[e][t]!==O)return r;var i=X.map(function(a){var r=Object(U.a)(a,2),i=r[0],c=r[1];return function(a){return F(e+i,t+c,n,a)}});return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce(function(e,t){return t(e)},e)}}.apply(void 0,Object(P.a)(i))(r)}function J(e){return Object(G.a)({},e,{minefield:M(e.width,e.height,e.mines),statemap:Array(e.width).fill(void 0).map(function(t){return new Uint8Array(e.height)}),gameState:f,flags:0})}function K(e,t){for(var n,a=t.payload,r=a.x,i=a.y,c=0;c<=1e4;c++){if(1e4===c)throw new Error("Error generating map");if((n=M(e.width,e.height,e.mines))[r][i]===O)break}return Object(G.a)({},e,{minefield:n})}function V(e,t){if(e.gameState!==f&&e.gameState!==h)return e;var n=t.payload,a=n.x,r=n.y,i=e.statemap[a][r];if(i===j||i===S)return e;var c=e.minefield[a][r];if(c===b){var s=e.statemap.map(function(t,n){return t.map(function(t,a){return e.minefield[n][a]===b?j:t})}),o=D(k,a,r,s);return Object(G.a)({},e,{statemap:o,gameState:d})}var u=c===O?F(a,r,e.minefield,e.statemap):D(j,a,r,e.statemap);if(u.reduce(function(e,t,n){return e+t.reduce(function(e,t,n){return t!==j?e+1:e},0)},0)!==e.mines)return Object(G.a)({},e,{statemap:u,gameState:h});var m=u.map(function(t,n){return t.map(function(t,a){return e.minefield[n][a]===b?S:j})});return Object(G.a)({},e,{statemap:m,gameState:v,flags:e.mines})}function W(e,t){return Object(G.a)({},e,{isPlaying:!0})}function Y(e,t){return Object(G.a)({},e,{width:t.payload.width,height:t.payload.heigth})}function H(e,t){return Object(G.a)({},e,{mines:t.payload.mines})}function Z(e,t){if(e.gameState!==f&&e.gameState!==h)return e;var n=t.payload,a=n.x,r=n.y,i=e.statemap[a][r];if(i!==E&&i!==S&&i!==w)return e;var c,s=e.flags;switch(i){case E:s++,c=S;break;case S:s--,c=w;break;case w:c=E;break;default:throw new Error("Unexpected state")}var o=D(c,a,r,e.statemap);return Object(G.a)({},e,{statemap:o,flags:s})}var q=J({width:9,height:9,mines:10,minefield:void 0,statemap:void 0,gameState:f,flags:0}),z=Object(L.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;return Object(B.a)({INIT:J,MAKE_MAP_BY_POINT:K,OPEN_CELL:V,START:W,RESIZE:Y,SET_MINES:H,TOGGLE_FLAG:Z},e)(e,t)},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(r.a.createElement(s.a,{store:z},r.a.createElement(x,null)),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.931bc55f.chunk.js.map